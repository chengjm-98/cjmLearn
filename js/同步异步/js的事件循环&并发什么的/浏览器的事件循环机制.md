<!--
 * @Author: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git
 * @Date: 2025-12-28 20:36:56
 * @LastEditors: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git
 * @LastEditTime: 2025-12-29 01:02:14
 * @FilePath: /cjmLearn/js/同步异步/js的事件循环&并发什么的/浏览器的事件循环机制.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->

# 事件循环机制

## 为什么要使用事件循环机制？

因为 js 是单线程的，所以需要使用事件循环机制来处理异步任务。

## 事件循环机制的过程

- 执行同步任务：首先，浏览器会执行主线程中的所有同步任务（即代码块、函数调用等）。
- 执行微任务：

  - 在执行完同步任务后，事件循环会检查微任务队列（Microtask Queue），并执行所有排队的微任务。
  - 微任务包括：Promise 的 .then 或 .catch 回调、MutationObserver 等。
  - 微任务队列会在每个宏任务执行前被清空。

- 渲染操作（如果有）

  - 微任务执行完成后，浏览器会执行渲染操作（如果有的话），如重新绘制页面、更新视图等。
  - 渲染操作的目的是确保用户能够看到最新的界面变化。

- 执行宏任务：
  - 事件循环会从宏任务队列（Macrotask Queue）中取出下一个任务进行执行。常见的宏任务有：
    setTimeout、setInterval、requestAnimationFrame
  - 网络请求的回调（如 XMLHttpRequest 或 fetch）
  - 用户事件（如点击、键盘输入）
- 如果在执行宏任务的过程中，又产生了新的微任务
  - 那么新的微任务会到哦微任务队列中，等当前宏任务执行完，事件循环会立即执行这些微任务。

重复以上步骤：事件循环会不断循环执行以上步骤，直到所有任务完成。
