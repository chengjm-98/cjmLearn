# 虚拟列表本质做了什么

- **只渲染“可视区域”**
- 最主流的是接口分页+虚拟列表

```jsx
- 列表总数据：假设 10 万条
- 实际 DOM：只渲染 10 ～ 20 条
- 每一项是 图片 + 文本卡片
- 滚动到底 → 自动加载下一页数据
- 图片进入可视区才请求
- 加一个buffer区间，防止快速滚动白屏
```

# 关键的属性

## scrollTop

- 当前滚动了多少距离（向下滚动的距离）
- 用途
  - 计算当前在第几行
  - 判断是否触底
  - 计算可视区起始索引

## scrollHeight/scrollWidth

- 内容的总高度（包括看不见的）
- 包含可视区域加滚出去的内容
- 永远 ≥ clientHeight

## clientHeight/clientWidth

- 容器的可视高度 container.clientHeight
- 不包含滚动条/不包含 padding/不包含 border，用户能看到的那一屏的高度

### 判断是否触底

- scrollTop + clientHeight ≥ scrollHeight
- 即 滚动了多少 + 可视区域的高度 ≥ 内容的总高度

```jsx
if (scrollTop + clientHeight > el.scrollHeight - 300) {
  fetchData();
}
```

## 具体实现

- 虚拟列表
  - 列表项 固定高度
  - 根据 scrollTop 计算：startIndex，endIndex
  - 用 paddingTop / paddingBottom 撑起滚动条
- 图片懒加载
  - 使用 IntersectionObserver
  - 图片进入可视区才设置 src
  - 无限滚动
- 滚动接近底部 → 模拟接口请求
  - 数据 append，不影响虚拟逻辑
