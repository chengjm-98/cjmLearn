<!--
 * @Author: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git
 * @Date: 2026-01-26 17:23:02
 * @LastEditors: error: error: git config user.name & please set dead value or install git && error: git config user.email & please set dead value or install git & please set dead value or install git
 * @LastEditTime: 2026-01-26 17:32:48
 * @FilePath: /cjmLearn/遇到的问题/前端权限问题/垂直越权&水平越权.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->

# 什么是越权

垂直越权是指低权限用户执行了本不属于自己权限范围的操作，比如普通用户调用管理员接口；
水平越权是指同权限用户操作了不属于自己的数据，比如用户 A 访问或修改用户 B 的订单。
在实际项目中，需要在后端同时做权限校验（垂直）和资源归属校验（水平），前端只做展示和体验控制，不能作为安全手段。

# 垂直越权（Vertical Privilege Escalation）

- 低权限用户，执行了高权限才能做的操作

## 举例

- 直接访问后台页面
  - 前端菜单没显示
  - 但接口和路由没做权限校验
  - 手输 URL 直接进

## 原因

- 只做了前端权限
- 后端接口没做权限校验
- 权限码设计不严谨

## 解决

- 后端接口做权限校验
- 返回403
- RBAC / ABAC

# 水平越权

同一权限级别的用户，操作了不属于自己的资源

## 举例

- 删除别人的订单
- 用户 A 有 order:delete，订单 123 是用户 B 的，后端没校验归属关系

## 原因

- 后端信任了前端传的参数

## 解决办法

- 后端不信任前端传的用户信息，用户身份只从 token 中获取；
- 在操作资源时，根据资源 ID 查询数据，再校验资源的 owner 是否是当前用户。

# 严谨点的判断方法

1. 是否登录
2. 是否有操作权限（垂直）
3. 是否是资源所有者（水平）

# 问题

Q1：前端按钮控制算不算权限控制？

答：

不算真正的权限控制，只是体验层控制。
真正的权限必须在后端接口层校验，否则可以通过抓包或直接调用接口绕过。
