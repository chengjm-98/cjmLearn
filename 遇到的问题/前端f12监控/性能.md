# performance 使用

```jsx
打开 Performance勾选：Screenshots,Web Vitals
点击 Record,刷新页面,Stop
```

## f12 中 moretools 中 Performance Monitor 性能指标

| 指标    | 含义         | 面试要点         |
| ------- | ------------ | ---------------- |
| FP      | 首次绘制     | 有像素           |
| FCP     | 首次内容绘制 | 有文字/图片      |
| **LCP** | 最大内容绘制 | **首屏指标核心** |
| CLS     | 布局偏移     | 抖动             |
| INP     | 交互响应     | 替代 TTI         |

- cpu usage ：cpu 使用率
- js heap size ：js 堆内存大小
- dom nodes ：dom 节点数量
- listeners ：事件监听器数量

## 还可以根据 Performance 工具进行录视频得到分析报告 record 录制

- fps 图表
- cpu 图表
- 火焰图

## 还可以根据 Show Renderings 进行分析

- 可以看到主要把 cpu 耗费在了什么地方

# memory 面板

查看有没有内存泄漏

- 方法 1：Heap Snapshot（堆快照）
  - 打开 DevTools → Memory → Heap snapshot → Take snapshot
  - 执行页面操作（如打开弹窗、滚动、切换 tab）
  - 再次 Take snapshot
  - 对比两个快照
  - 看 Objects Count 和 Retained Size
- 重点关注：
  - Detached DOM nodes（已脱离文档树但仍被 JS 引用）
  - Event listeners 未清理
  - 长生命周期 JS 对象
  - 如果快照对比中对象数量持续增加，说明可能有泄漏。
- 方法 2：Allocation instrumentation on timeline（时间轴分配）
  - Memory → Allocation instrumentation on timeline → Start
  - 执行页面操作（模拟用户行为）
  - Stop 录制 → 观察时间轴
  - 关注：
    - 对象分配峰值
    - 对象分配后是否持续存在（Retained）
    - 如果峰值不下降 → 内存泄漏
- 方法 3：实时监控 Memory Usage
  - DevTools → Performance → Record 页面操作
  - 右侧 Memory 面板观察 JS Heap
  - 手动触发垃圾回收（点击 Collect garbage）
  - 观察：
  - 内存是否回落
  - 如果操作后内存持续上升 → 泄漏可能
