# æ¥å£ interface

## å®šä¹‰

æ¥å£æ˜¯å¯¹è¡Œä¸ºçš„æŠ½è±¡ï¼Œè€Œå…·ä½“å¦‚ä½•è¡ŒåŠ¨éœ€è¦ç”±ç±»å»å®ç°ã€‚?  
TypeScript çš„æ ¸å¿ƒåŸåˆ™ä¹‹ä¸€æ˜¯å¯¹å€¼æ‰€å…·æœ‰çš„ç»“æ„è¿›è¡Œç±»å‹æ£€æŸ¥ã€‚ å®ƒæœ‰æ—¶è¢«ç§°åšâ€œé¸­å¼è¾¨å‹æ³•â€æˆ–â€œç»“æ„æ€§å­ç±»å‹åŒ–â€ã€‚ åœ¨ TypeScript é‡Œï¼Œæ¥å£çš„ä½œç”¨å°±æ˜¯ä¸ºè¿™äº›ç±»å‹å‘½åå’Œä¸ºä½ çš„ä»£ç æˆ–ç¬¬ä¸‰æ–¹ä»£ç å®šä¹‰å¥‘çº¦ã€‚

## å¯é€‰

```js
interface SquareConfig {
  color?: string;
  width?: number;
}
```

## åªè¯»

```js
interface Point {
    readonly x: number;
    readonly y: number;
}
```

**readonly vs const**
æœ€ç®€å•åˆ¤æ–­è¯¥ç”¨ readonly è¿˜æ˜¯ const çš„æ–¹æ³•æ˜¯çœ‹è¦æŠŠå®ƒåšä¸ºå˜é‡ä½¿ç”¨è¿˜æ˜¯åšä¸ºä¸€ä¸ªå±æ€§ã€‚ åšä¸ºå˜é‡ä½¿ç”¨çš„è¯ç”¨ constï¼Œè‹¥åšä¸ºå±æ€§åˆ™ä½¿ç”¨ readonlyã€‚  
ğŸ”´**è¯´äººè¯**  
å¦‚æœä½ æƒ³è¦å˜é‡æœ¬èº«ä¸å¯ä¿®æ”¹ï¼Œå°±ä½¿ç”¨ constï¼Œä½†æ˜¯ const å®šä¹‰äº†å˜é‡ï¼Œå˜é‡å†…éƒ¨çš„å±æ€§è¿˜æ˜¯å¯ä»¥ä¿®æ”¹ã€‚  
å¦‚æœä½ æƒ³è¦å˜é‡çš„å±æ€§ä¸å¯ä¿®æ”¹ï¼Œå°±ä½¿ç”¨ readonlyã€‚

## é¢å¤–çš„å±æ€§æ£€æŸ¥

```js
interface objType {
  name: string;
}
function setPersonMsg(item: objType) {
  console.log("è¾“å…¥å§“å:" + item.name);
}
setPersonMsg({ name: "cjm", age: 26 }); //ä¼šæŠ¥é”™
```

ä¸Šé¢è¿™æ®µä»£ç ä¼šæŠ¥é”™ Object literal may only specify known properties, and 'age' does not exist in type 'objType'.  
å› ä¸º age ä¸åœ¨ objType ä¸­ï¼Œage æ˜¯ä¸€ä¸ªé¢å¤–çš„å±æ€§  
ä½ å¯èƒ½ä¼šäº‰è¾©è¿™ä¸ªç¨‹åºå·²ç»æ­£ç¡®åœ°ç±»å‹åŒ–äº†ï¼Œå› ä¸º name å±æ€§æ˜¯å…¼å®¹çš„ï¼Œä¸å­˜åœ¨ age å±æ€§ï¼Œè€Œä¸”é¢å¤–çš„ age å±æ€§æ˜¯æ— æ„ä¹‰çš„ã€‚

ç„¶è€Œï¼ŒTypeScript ä¼šè®¤ä¸ºè¿™æ®µä»£ç å¯èƒ½å­˜åœ¨ bugã€‚ å¯¹è±¡å­—é¢é‡ä¼šè¢«ç‰¹æ®Šå¯¹å¾…è€Œä¸”ä¼šç»è¿‡ ğŸ”´ **é¢å¤–å±æ€§æ£€æŸ¥**ï¼Œå½“å°†å®ƒä»¬èµ‹å€¼ç»™å˜é‡æˆ–ä½œä¸ºå‚æ•°ä¼ é€’çš„æ—¶å€™ã€‚ å¦‚æœä¸€ä¸ªå¯¹è±¡å­—é¢é‡å­˜åœ¨ä»»ä½•â€œç›®æ ‡ç±»å‹â€ä¸åŒ…å«çš„å±æ€§æ—¶ï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªé”™è¯¯ã€‚

**å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿ**

1. ç±»å‹æ–­è¨€ï¼ˆä¸æ¨èï¼Œå¯èƒ½æœ‰ä¸€äº›æ½œåœ¨çš„é”™è¯¯ï¼‰

```js
setPersonMsg({ name: "cjm",age:26}as objType);
```

2. ä½¿ç”¨å¯¹è±¡ä¼ å…¥ï¼ˆä¸ä¼šè¿›è¡Œé¢å¤–çš„å±æ€§æ£€æŸ¥ï¼‰
   ```js
   interface objType {
     name: string;
   }
   let item = {
     name: "cjm",
     age: 26,
   };
   function setPersonMsg(item: objType) {
     console.log("è¾“å…¥å§“å:" + item.name);
   }
   setPersonMsg(item);
   ```
3. ä½¿ç”¨ç´¢å¼•ç­¾å  
    å¦‚æœ objType å¸¦æœ‰ä¸Šé¢å®šä¹‰çš„ç±»å‹çš„ name å±æ€§ï¼Œå¹¶ä¸”è¿˜ä¼šå¸¦æœ‰ä»»æ„æ•°é‡çš„å…¶å®ƒå±æ€§ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰å®ƒï¼š
   ```js
   interface objType {
     name: string;
     [propName: string]: any;
   }
   ```

## å‡½æ•°ç±»å‹

**ä½¿ç”¨æ¥å£æ¥æè¿°å‡½æ•°ç±»å‹**

```js
interface SearchFunc {
  (source: string, subString: string): boolean;
}
let mySearch: SearchFunc;
mySearch = function (source: string, subString: string) {
  let result = source.search(subString);
  return result > -1;
};
```

## æè¿°ç±»

æ¥å£åªèƒ½æè¿°ç±»çš„å…¬å…±éƒ¨åˆ†ï¼Œç§æœ‰éƒ¨åˆ†è¿˜æœ‰é™æ€éƒ¨åˆ†ä¸èƒ½æè¿°ï¼ŒåŒ…æ‹¬æ„é€ å‡½æ•°ã€‚

```js
interface ClockInterface {
    currentTime: Date;
    setTime(d: Date);
}

class Clock implements ClockInterface {
    currentTime: Date;
    constructor(h: number, m: number) { }
    setTime(d: Date) {
        this.currentTime = d;
    }
}
```

è¿™æ ·æ˜¯é”™è¯¯çš„,å¦‚æœæƒ³æè¿°æ„é€ å‡½æ•°ï¼Œä½¿ç”¨æ„é€ ç­¾åæ¥å£ã€‚è§ä¸‹æ–¹ã€‚

```js
interface ClockInterface {
    currentTime: Date;
    setTime(d: Date);
    new (hour: number, minute: number): ClockInterface;   //è¿™æ ·æ˜¯é”™è¯¯çš„
}
```

### æ„é€ å™¨ç­¾åæ¥å£

```js
interface constructorInterface {
  new(å‚æ•°åˆ—è¡¨): ç±»å‹;
}
```

å› æ­¤ï¼Œæˆ‘ä»¬åº”è¯¥ç›´æ¥æ“ä½œç±»çš„é™æ€éƒ¨åˆ†ã€‚ çœ‹ä¸‹é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªæ¥å£ï¼Œ ClockConstructor ä¸ºæ„é€ å‡½æ•°æ‰€ç”¨å’Œ ClockInterface ä¸ºå®ä¾‹æ–¹æ³•æ‰€ç”¨ã€‚ ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæ„é€ å‡½æ•° createClockï¼Œå®ƒç”¨ä¼ å…¥çš„ç±»å‹åˆ›å»ºå®ä¾‹ã€‚

\*_è¿™æ˜¯ä¸€ä¸ªå·¥å‚æ–¹æ³•è®¾è®¡æ¨¡å¼çš„ä»£ç ï¼š_

```js
//è¿™æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ç­¾åæ¥å£
interface ClockConstructor {
    new (hour: number, minute: number): ClockInterface;
}
//è¿™ä¸ªæ˜¯ç±»çš„æ¥å£ï¼Œå®ç°ä¸€ä¸ªtickå…¬å…±æ–¹æ³•
interface ClockInterface {
    tick();
}
//è¿™ä¸ªæ˜¯å·¥å‚æ–¹æ³•   ä¼ å…¥ä¸€ä¸ªæ„é€ å‡½æ•°å’Œä¸¤ä¸ªå‚æ•° è¿”å›ä¸€ä¸ªClockInterfaceç±»å‹çš„å¯¹è±¡
function createClock(ctor: ClockConstructor, hour: number, minute: number): ClockInterface {
    return new ctor(hour, minute);
}
//è¿™ä¸ªæ˜¯å®ç°ç±» ç»§æ‰¿è‡ªClockInterface
class DigitalClock implements ClockInterface {
    constructor(h: number, m: number) { }
    tick() {
        console.log("beep beep");
    }
}
//è¿™ä¸ªæ˜¯å¦å¤–ä¸€ä¸ªå®ç°ç±» ç»§æ‰¿è‡ªClockInterface
class AnalogClock implements ClockInterface {
    constructor(h: number, m: number) { }
    tick() {
        console.log("tick tock");
    }
}
//è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¹‹æ‰€ä»¥ä¼ å…¥DigitalClockç±» æ˜¯å› ä¸ºç±»æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚
let digital = createClock(DigitalClock, 12, 17);
let analog = createClock(AnalogClock, 7, 32);
```

## implements å…³é”®å­—

ç”¨äºç±»å®ç°æ¥å£  
1ï¸âƒ£ åªèƒ½çº¦æŸå…¬å…±éƒ¨åˆ†ï¼ˆå®ä¾‹éƒ¨åˆ†ï¼‰ï¼Œä¸èƒ½çº¦æŸé™æ€éƒ¨åˆ†ï¼ŒåŒ…æ‹¬æ„é€ å‡½æ•°ã€‚  
2ï¸âƒ£ implements å¤šä¸ªæ¥å£

```js
interface Animal {
  name: string;
  makeSound(): void;
}

interface Pet {
  owner: string;
}

class Dog implements Animal, Pet {
  name: string;
  owner: string;

  constructor(name: string, owner: string) {
    this.name = name;
    this.owner = owner;
  }

  makeSound() {
    console.log("Woof!");
  }
}

const myDog = new Dog("Max", "John");
console.log(myDog.name); // Max
console.log(myDog.owner); // John
myDog.makeSound(); // Woof!
```

## ç»§æ‰¿æ¥å£

å’Œç±»ä¸€æ ·ï¼Œæ¥å£ä¹Ÿå¯ä»¥ç›¸äº’ç»§æ‰¿ã€‚ è¿™è®©æˆ‘ä»¬èƒ½å¤Ÿä»ä¸€ä¸ªæ¥å£é‡Œå¤åˆ¶æˆå‘˜åˆ°å¦ä¸€ä¸ªæ¥å£é‡Œï¼Œå¯ä»¥æ›´çµæ´»åœ°å°†æ¥å£åˆ†å‰²åˆ°å¯é‡ç”¨çš„æ¨¡å—é‡Œã€‚  
1ï¸âƒ£ å¯ä»¥å•ç‹¬ç»§æ‰¿  
2ï¸âƒ£ ä¸€ä¸ªæ¥å£å¯ä»¥ç»§æ‰¿å¤šä¸ªæ¥å£

```js
interface Animal {
  name: string;
  makeSound(): void;
}

interface Pet {
  owner: string;
}

interface Dog extends Animal, Pet {
  home: string;
}
let dog: Dog = {
  name: "æ—ºè´¢",
  makeSound() {
    console.log("æ±ªæ±ªæ±ª");
  },
  owner: "å¼ ä¸‰",
  home: "åŒ—äº¬",
};
console.log(dog);
```

## æ··åˆç±»å‹

å…ˆå‰æˆ‘ä»¬æè¿‡ï¼Œæ¥å£èƒ½å¤Ÿæè¿° JavaScript é‡Œä¸°å¯Œçš„ç±»å‹ã€‚ å› ä¸º JavaScript å…¶åŠ¨æ€çµæ´»çš„ç‰¹ç‚¹ï¼Œæœ‰æ—¶ä½ ä¼šå¸Œæœ›ä¸€ä¸ªå¯¹è±¡å¯ä»¥åŒæ—¶å…·æœ‰ä¸Šé¢æåˆ°çš„å¤šç§ç±»å‹ã€‚

ä¸€ä¸ªä¾‹å­å°±æ˜¯ï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥åŒæ—¶åšä¸ºå‡½æ•°å’Œå¯¹è±¡ä½¿ç”¨ï¼Œå¹¶å¸¦æœ‰é¢å¤–çš„å±æ€§ã€‚

```js
interface Counter {
    (start: number): string;
    interval: number;
    reset(): void;
}

function getCounter(): Counter {
    let counter = <Counter>function (start: number) { };
    counter.interval = 123;
    counter.reset = function () { };
    return counter;
}

let c = getCounter();
c(10);
c.reset();
c.interval = 5.0;
```

## æ¥å£ç»§æ‰¿ç±»

å½“æ¥å£ç»§æ‰¿äº†ä¸€ä¸ªç±»ç±»å‹æ—¶ï¼Œå®ƒä¼šç»§æ‰¿ç±»çš„æˆå‘˜ä½†ä¸åŒ…æ‹¬å…¶å®ç°,æ¥å£åŒæ ·ä¼šç»§æ‰¿åˆ°ç±»çš„ private å’Œ protected æˆå‘˜ã€‚  
ä½†æ˜¯ç”±äºå®ƒçš„ç§æœ‰å˜é‡åªèƒ½æ˜¯è‡ªå·±æ‰èƒ½è®¿é—®ï¼Œæ‰€ä»¥å¦‚æœåˆ«çš„ç±»æ¥å®ç°è¿™ä¸ªæ¥å£ï¼Œå°±ä¼šæŠ¥é”™ã€‚  
æ¯”å¦‚ï¼š

```js
class Control {
  private state: any = 1;
}

interface SelectableControl extends Control {
  select(): void;
}
//è¿™æ ·ä¼šæŠ¥é”™
class Button implements SelectableControl {
  private state: any;
  select() {
    console.log("button");
  }
}
//è¿™æ ·ä¹Ÿä¼šæŠ¥é”™
class Button2 implements SelectableControl {
  select() {
    console.log("button");
  }
}
```

**è§£é‡Šä¸€ä¸‹**  
SelectableControl åŒ…æ‹¬äº† Control çš„ç§æœ‰æˆå‘˜ state å’Œ select æ–¹æ³•ã€‚  
Button å®ç°äº† SelectableControlï¼Œä½†æ˜¯ç§æœ‰å˜é‡ä¸èƒ½è¢«é™¤äº†æœ¬èº«çš„ class çš„è®¿é—®ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚  
Button2 å®ç°äº† SelectableControlï¼Œä½†æ˜¯å®ƒæ²¡æœ‰å®ç° Control çš„ç§æœ‰æˆå‘˜ state å’Œ select æ–¹æ³•ï¼Œæ‰€ä»¥ä¹Ÿä¼šæŠ¥é”™ã€‚

**è§£å†³åŠæ³•ï¼š**  
è¿™æ ·ä¸ä¼šæŠ¥é”™

```js
class Control {
  private state: any = 1;
}

interface SelectableControl extends Control {
  select(): void;
}

class Button extends Control implements SelectableControl {
  select() {
    console.log("button");
  }
}

```
